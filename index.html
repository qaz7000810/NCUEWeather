<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>彰師大氣象觀測網站</title>
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <header class="header">
    <div>
      <p class="eyebrow">彰師大氣象觀測網站</p>
      <p class="eyebrow">CWA O-A0003-001 | 彰師大測站</p>
      <p class="eyebrow">環境部 AQI | 彰化測站</p>
      <h1>彰師大即時氣象與空品</h1>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab-btn active" data-tab-target="realtime">即時天氣</button>
    <button class="tab-btn" data-tab-target="rankings">彰化縣氣象地圖</button>
    <button class="tab-btn" data-tab-target="taiwan-rankings">台灣氣象地圖</button>
    <button class="tab-btn" data-tab-target="disaster">防災地圖</button>
    <button class="tab-btn" data-tab-target="historical">歷史資料</button>
  </nav>

  <main class="tab-panel active" data-tab="realtime">
    <section class="panel">
      <div class="controls">
        <div class="control buttons">
          <button id="refreshRealtimeBtn" class="primary">更新全部</button>
          <button id="clearRealtimeBtn" class="ghost">清空</button>
        </div>
        <div class="control">
          <label>狀態</label>
          <div class="status" id="realtimeStatus">尚未請求</div>
        </div>
      </div>
    </section>

    <section class="panel realtime-grid">
      <div class="realtime-card">
        <div class="realtime-card-header">
          <div>
            <p class="eyebrow">O-A0003-001</p>
            <h3>彰師大測站即時觀測</h3>
          </div>
          <button id="reloadNCUEBtn" class="ghost">重新載入</button>
        </div>
        <div class="status" id="ncueStatus">尚未載入</div>
        <div id="ncueObservation" class="data-list"></div>
      </div>

      <div class="realtime-card">
        <div class="realtime-card-header">
          <div>
            <p class="eyebrow">環境部 AQI</p>
            <h3>彰化測站空氣品質</h3>
          </div>
          <button id="reloadAqiBtn" class="ghost">重新載入</button>
        </div>
        <div class="status" id="aqiStatus">尚未載入</div>
        <div id="aqiObservation" class="data-list"></div>
      </div>

      <div class="realtime-card">
        <div class="realtime-card-header">
          <div>
            <p class="eyebrow">W-C0033-001</p>
            <h3>天氣警特報</h3>
          </div>
          <button id="reloadAlertsBtn" class="ghost">重新整理</button>
        </div>
        <div id="alertList" class="alert-list ghost-status">尚未載入</div>
      </div>

      <div class="realtime-card">
        <div class="realtime-card-header">
          <div>
            <p class="eyebrow">F-C0032-001</p>
            <h3>未來 36 小時預報</h3>
          </div>
          <button id="reloadForecastBtn" class="ghost">重新整理</button>
        </div>
        <div id="forecastSlots" class="forecast-cards"></div>
      </div>
    </section>

    <section class="panel">
      <div class="realtime-card-header">
        <div>
          <p class="eyebrow">W-C0034-005</p>
          <h3>即時颱風消息與路徑</h3>
        </div>
        <button id="reloadLiveTyphoonBtn" class="ghost">重新整理</button>
      </div>
      <div id="liveTyphoonMap" class="map-shell small-map"></div>
      <div id="typhoonLiveList" class="typhoon-live-list ghost-status">尚未載入</div>
    </section>
  </main>

  
<main class="tab-panel" data-tab="historical">
    <section class="panel">
      <div class="controls">
        <div class="control">
          <label for="stationSelect">測站</label>
          <select id="stationSelect"></select>
        </div>
        <div class="control">
          <label>指標</label>
          <div class="pill">一次載入4個指標：氣溫、降雨量、濕度、風速</div>
        </div>
        <div class="control">
          <label for="rollupSelect">彙整尺度</label>
          <select id="rollupSelect">
            <option value="day">日尺度</option>
            <option value="hour">小時尺度</option>
          </select>
        </div>
        <div class="control buttons">
          <button id="loadBtn" class="primary">重新載入</button>
          <button id="clearBtn" class="ghost">清空圖表</button>
        </div>
        <div class="control">
          <label>狀態</label>
          <div class="status" id="status">尚未載入</div>
        </div>
      </div>

      <div class="timeline">
        <div class="timeline-row">
          <label>起迄月份</label>
          <span id="rangeLabel"></span>
        </div>
        <div class="slider">
          <input type="range" id="rangeStart" min="0" max="0" step="1" value="0" />
          <input type="range" id="rangeEnd" min="0" max="0" step="1" value="0" />
        </div>
      </div>
    </section>

    <section class="panel chart-panel">
      <div class="chart-header">
        <div>
          <p class="eyebrow">互動折線圖</p>
          <h2 id="chartTitle">尚未載入資料</h2>
        </div>
      </div>
      <div class="chart-grid">
        <div class="chart-card">
          <div class="chart-card-header">氣溫 (°C)</div>
          <div class="chart-shell"><canvas id="chart-TX01"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-card-header">降雨量 (mm)</div>
          <div class="chart-shell"><canvas id="chart-PP01"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-card-header">相對濕度 (%)</div>
          <div class="chart-shell"><canvas id="chart-RH01"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-card-header">風速 (m/s)</div>
          <div class="chart-shell"><canvas id="chart-WD01"></canvas></div>
        </div>
      </div>
      <div class="hint">
        <p>提示：若有日彙整檔（<code>web/data/daily/*.daily.json</code>）會優先採用，載入較快；若需逐小時則改用原始 <code>*.auto_hr.txt</code>。</p>
      </div>
    </section>
  </main>

  <main class="tab-panel" data-tab="rankings">
    <section class="panel">
      <div class="controls">
        <div class="control">
          <label for="rankingMetric">排名指標</label>
          <select id="rankingMetric"></select>
        </div>
        <div class="control buttons">
          <button id="reloadRankingBtn" class="primary">更新排名</button>
        </div>
        <div class="control">
          <label>狀態</label>
          <div class="status" id="rankingStatus">尚未載入</div>
        </div>
      </div>
    </section>

    <section class="panel ranking-layout">
      <div class="ranking-map">
        <div id="rankingMap" class="map-shell"></div>
        <div class="hint">滑鼠移到鄉鎮可查看排行，點擊測站標記可對應表格。</div>
        <div id="rankingColorbar" class="colorbar-card"></div>
      </div>
      <div class="ranking-table">
        <div class="table-card">
          <div class="table-header">
            <span>彰化測站即時排行</span>
            <span id="rankingDataTime" class="table-header-time"></span>
          </div>
          <table id="rankingTable">
            <thead>
              <tr>
                <th>排序</th>
                <th>鄉鎮</th>
                <th>測站</th>
                <th>風向</th>
                <th>溫度</th>
                <th>濕度</th>
                <th id="rankingValueHeader">數值</th>
              </tr>
            </thead>
            <tbody id="rankingTableBody"></tbody>
          </table>
          <div class="table-footer" id="rankingPager"></div>
        </div>
      </div>
    </section>
  </main>

  <main class="tab-panel" data-tab="taiwan-rankings">
    <section class="panel">
      <div class="controls">
        <div class="control">
          <label for="taiwanRankingMetric">排名指標</label>
          <select id="taiwanRankingMetric"></select>
        </div>
        <div class="control">
          <label for="taiwanRankingCounty">縣市</label>
          <select id="taiwanRankingCounty"></select>
        </div>
        <div class="control buttons">
          <button id="taiwanReloadRankingBtn" class="primary">更新排名</button>
        </div>
        <div class="control">
          <label>狀態</label>
          <div class="status" id="taiwanRankingStatus">尚未載入</div>
        </div>
      </div>
    </section>

    <section class="panel ranking-layout">
      <div class="ranking-map">
        <div id="taiwanRankingMap" class="map-shell"></div>
        <div class="hint">滑鼠移到縣市可查看排行，點擊測站標記可對應表格。</div>
        <div id="taiwanRankingColorbar" class="colorbar-card"></div>
      </div>
      <div class="ranking-table">
        <div class="table-card">
          <div class="table-header">
            <span>台灣測站即時排行</span>
            <span id="taiwanRankingDataTime" class="table-header-time"></span>
          </div>
          <table id="taiwanRankingTable">
            <thead>
              <tr>
                <th>排序</th>
                <th>縣市</th>
                <th>鄉鎮</th>
                <th>測站</th>
                <th>風向</th>
                <th>溫度</th>
                <th>濕度</th>
                <th id="taiwanRankingValueHeader">數值</th>
              </tr>
            </thead>
            <tbody id="taiwanRankingTableBody"></tbody>
          </table>
          <div class="table-footer" id="taiwanRankingPager"></div>
        </div>
      </div>
    </section>
  </main>

  <main class="tab-panel" data-tab="disaster">
    <section class="panel">
      <div class="controls">
        <div class="control">
          <label for="disasterMetric">指標</label>
          <select id="disasterMetric"></select>
        </div>
        <div class="control buttons">
          <button id="disasterReloadBtn" class="primary">更新列表</button>
        </div>
        <div class="control">
          <label>狀態</label>
          <div class="status" id="disasterStatus">尚未載入</div>
        </div>
      </div>
    </section>

    <section class="panel ranking-layout">
      <div class="ranking-map">
        <div id="disasterMap" class="map-shell"></div>
        <div class="hint">僅顯示易致災門檻的測站。</div>
        <div id="disasterColorbar" class="colorbar-card"></div>
      </div>
      <div class="ranking-table">
        <div class="table-card">
          <div class="table-header">
            <span>防災測站即時監測</span>
            <span id="disasterDataTime" class="table-header-time"></span>
          </div>
          <table id="disasterTable">
            <thead>
              <tr>
                <th>排序</th>
                <th>縣市</th>
                <th>鄉鎮</th>
                <th>測站</th>
                <th>風向</th>
                <th>溫度</th>
                <th>濕度</th>
                <th id="disasterValueHeader">數值</th>
                <th>警戒等級</th>
              </tr>
            </thead>
            <tbody id="disasterTableBody"></tbody>
          </table>
          <div class="table-footer" id="disasterPager"></div>
        </div>
      </div>
    </section>
  </main>

  <script src="./app.js" type="module"></script>
</body>
</html>
